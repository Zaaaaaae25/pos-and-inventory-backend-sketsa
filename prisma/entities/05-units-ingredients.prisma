/// ========== UNITS & INGREDIENTS ==========
model Unit {
  id           Int    @id @default(autoincrement())
  name         String @unique
  abbreviation String @unique

  ingredients       Ingredient[]
  outletIngredients OutletIngredient[]

  @@map("units")
}

model OutletIngredient {
  id       Int     @id @default(autoincrement())
  outletId Int?    @map("outlet_id")
  name     String
  unitId   Int     @map("unit_id")
  stock    Decimal @db.Decimal(12, 2) @default(0)

  outlet Outlet? @relation(fields: [outletId], references: [id], onDelete: SetNull)
  unit   Unit    @relation(fields: [unitId], references: [id], onDelete: Restrict)

  @@map("outlet_ingredients")
}

model Ingredient {
  id    Int     @id @default(autoincrement())
  name  String
  unitId Int    @map("unit_id")
  cost  Decimal @db.Decimal(12, 2)

  unit               Unit              @relation(fields: [unitId], references: [id], onDelete: Restrict)
  recipes            Recipe[]
  warehouseStocks    WarehouseStock[]
  supplierProducts   SupplierProduct[]
  ingredientPackages IngredientPackage[]
  stockAdjustments   StockAdjustment[]
  stockTransfers     StockTransfer[]
  wastes             Waste[]

  @@map("ingredients")
}

model Recipe {
  id           Int     @id @default(autoincrement())
  menuId       Int     @map("menu_id")
  ingredientId Int     @map("ingredient_id")
  qty          Decimal @db.Decimal(12, 2)

  menu       Menu       @relation(fields: [menuId], references: [id], onDelete: Cascade)
  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Restrict)

  @@unique([menuId, ingredientId])
  @@map("recipes")
}
